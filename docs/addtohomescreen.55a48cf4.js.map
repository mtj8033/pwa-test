{"version":3,"sources":["addtohomescreen.js"],"names":["window","document","_eventListener","_DOMReady","readyState","addEventListener","loaded","removeEventListener","_reSmartURL","_instance","_reQueryString","ath","options","Class","lang","intl","cs_cs","ios","android","de_de","da_dk","el_gr","en_us","es_es","fi_fi","fr_fr","he_il","hu_hu","it_it","ja_jp","ko_kr","nb_no","pt_br","pt_pt","nl_nl","ru_ru","sk_sk","sv_se","tr_tr","uk_ua","zh_cn","zh_tw","substr","defaults","appID","fontSize","debug","logging","modal","mandatory","autostart","skipFirstVisit","startDelay","lifespan","displayPace","maxDisplayCount","icon","message","validLocation","onInit","onShow","onRemove","onAdd","onPrivate","privateModeOverride","detectHomescreen","_ua","navigator","userAgent","_nav","_extend","hasToken","location","hash","test","href","search","isRetina","devicePixelRatio","isIDevice","isMobileChrome","indexOf","isMobileIE","language","toLowerCase","replace","isMobileSafari","OS","OSVersion","match","isStandalone","standalone","isTablet","isCompatible","_defaultSession","lastDisplayTime","returningVisitor","displayCount","optedout","added","target","obj","i","_removeToken","history","replaceState","title","split","removeSession","localStorage","Error","removeItem","e","doLog","logStr","console","log","container","body","session","getItem","JSON","parse","undefined","setItem","stringify","hasLocalStorage","call","isValidLocation","length","optOut","updateSession","ready","show","prototype","events","load","error","orientationchange","resize","scroll","click","touchmove","transitionend","webkitTransitionEnd","MSTransitionEnd","handleEvent","type","force","shown","now","Date","applicationIcon","querySelector","matches","group1","viewport","createElement","className","style","position","element","parseInt","cssText","webkitTransform","innerHeight","transform","img","src","appendChild","innerHTML","left","_delayedShow","setTimeout","bind","_show","that","updateViewport","webkitTransitionDuration","transitionDuration","removeTimer","remove","clearTimeout","opacity","_removeElements","removeChild","width","innerWidth","height","scrollX","top","scrollY","clientWidth","documentElement","orientation","clientHeight","screenWidth","screen","scale","resizeTimer","clearSession","item","optIn","clearDisplayCount","_preventDefault","preventDefault","stopPropagation","addToHomescreen"],"mappings":"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","file":"addtohomescreen.55a48cf4.js","sourceRoot":"..","sourcesContent":["// https://raw.githubusercontent.com/docluv/add-to-homescreen/master/src/addtohomescreen.js\r\n/* Add to Homescreen v3.2.3 ~ (c) 2015 Matteo Spinelli ~ @license: http://cubiq.org/license */\r\n(function (window, document) {\r\n    /*\r\n           _   _ _____     _____\r\n     ___ _| |_| |_   _|___|  |  |___ _____ ___ ___ ___ ___ ___ ___ ___\r\n    | .'| . | . | | | | . |     | . |     | -_|_ -|  _|  _| -_| -_|   |\r\n    |__,|___|___| |_| |___|__|__|___|_|_|_|___|___|___|_| |___|___|_|_|\r\n                                  by Matteo Spinelli ~ http://cubiq.org\r\n    */\r\n\r\n    // Check for addEventListener browser support (prevent errors in IE<9)\r\n    var _eventListener = 'addEventListener' in window;\r\n\r\n    // Check if document is loaded, needed by autostart\r\n    var _DOMReady = false;\r\n    if (document.readyState === 'complete') {\r\n        _DOMReady = true;\r\n    } else if (_eventListener) {\r\n        window.addEventListener('load', loaded, false);\r\n    }\r\n\r\n    function loaded() {\r\n        window.removeEventListener('load', loaded, false);\r\n        _DOMReady = true;\r\n    }\r\n\r\n    // regex used to detect if app has been added to the homescreen\r\n    var _reSmartURL = /\\/ath(\\/)?$/;\r\n    var _reQueryString = /([\\?&]ath=[^&]*$|&ath=[^&]*(&))/;\r\n\r\n    // singleton\r\n    var _instance;\r\n    function ath(options) {\r\n        _instance = _instance || new ath.Class(options);\r\n\r\n        return _instance;\r\n    }\r\n\r\n    // message in all supported languages\r\n    ath.intl = {\r\n        cs_cs: {\r\n            ios: 'Pro přidáni této webové aplikace na úvodní obrazovku: stlačte %icon a pak <strong>Přidat na úvodní obrazovku</strong>.',\r\n            android: 'Pro přidáni této webové aplikace na úvodní obrazovku otevřete menu nastavení prohlížeče a stlačte <strong>Přidat na úvodní obrazovku</strong>. <small>K menu se dostanete stlačením hardwaroveho tlačítka, když ho vaše zařízení má, nebo stlačením pravé horní menu ikony <span class=\"ath-action-icon\">icon</span>.</small>'\r\n        },\r\n\r\n        de_de: {\r\n            ios: 'Um diese Web-App zum Home-Bildschirm hinzuzufügen, tippen Sie auf %icon und dann <strong>Zum Home-Bildschirm</strong>.',\r\n            android: 'Um diese Web-App zum Home-Bildschirm hinzuzufügen, öffnen Sie das Menü und tippen dann auf <strong>Zum Startbildschirm hinzufügen</strong>. <small>Wenn Ihr Gerät eine Menütaste hat, lässt sich das Browsermenü über diese öffnen. Ansonsten tippen Sie auf %icon.</small>'\r\n        },\r\n\r\n        da_dk: {\r\n            ios: 'For at tilføje denne web app til hjemmeskærmen: Tryk %icon og derefter <strong>Føj til hjemmeskærm</strong>.',\r\n            android: 'For at tilføje denne web app til hjemmeskærmen, åbn browser egenskaber menuen og tryk på <strong>Føj til hjemmeskærm</strong>. <small>Denne menu kan tilgås ved at trykke på menu knappen, hvis din enhed har en, eller ved at trykke på det øverste højre menu ikon %icon.</small>'\r\n        },\r\n\r\n        el_gr: {\r\n            ios: 'Για να προσθέσετε την εφαρμογή στην αρχική οθόνη: πατήστε το %icon και μετά <strong>Πρόσθεσε στην αρχική οθόνη</strong>.',\r\n            android: 'Για να προσθέσετε την εφαρμογή στην αρχική οθόνη, ανοίξτε τις επιλογές του browser σας και πατήστε το <strong>Προσθήκη στην αρχική οθόνη</strong>. <small>Μπορείτε να έχετε πρόσβαση στο μενού, πατώντας το κουμπί του μενού του κινητού σας ή το πάνω δεξιά κουμπί του μενού %icon.</small>'\r\n        },\r\n\r\n        en_us: {\r\n            ios: 'To add this web app to the home screen: tap %icon and then <strong>Add to Home Screen</strong>.',\r\n            android: 'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon %icon.</small>'\r\n        },\r\n\r\n        es_es: {\r\n            ios: 'Para añadir esta aplicación web a la pantalla de inicio: pulsa %icon y selecciona <strong>Añadir a pantalla de inicio</strong>.',\r\n            android: 'Para añadir esta aplicación web a la pantalla de inicio, abre las opciones y pulsa <strong>Añadir a pantalla inicio</strong>. <small>El menú se puede acceder pulsando el botón táctil en caso de tenerlo, o bien el icono de la parte superior derecha de la pantalla %icon.</small>'\r\n        },\r\n\r\n        fi_fi: {\r\n            ios: 'Liitä tämä sovellus kotivalikkoon: klikkaa %icon ja tämän jälkeen <strong>Lisää kotivalikkoon</strong>.',\r\n            android: 'Lisätäksesi tämän sovelluksen aloitusnäytölle, avaa selaimen valikko ja klikkaa tähti -ikonia tai <strong>Lisää aloitusnäytölle tekstiä</strong>. <small>Valikkoon pääsee myös painamalla menuvalikkoa, jos laitteessasi on sellainen tai koskettamalla oikealla yläkulmassa menu ikonia %icon.</small>'\r\n        },\r\n\r\n        fr_fr: {\r\n            ios: 'Pour ajouter cette application web sur l\\'écran d\\'accueil : Appuyez %icon et sélectionnez <strong>Ajouter sur l\\'écran d\\'accueil</strong>.',\r\n            android: 'Pour ajouter cette application web sur l\\'écran d\\'accueil : Appuyez sur le bouton \"menu\", puis sur <strong>Ajouter sur l\\'écran d\\'accueil</strong>. <small>Le menu peut-être accessible en appuyant sur le bouton \"menu\" du téléphone s\\'il en possède un <i class=\"fa fa-bars\"></i>. Sinon, il se trouve probablement dans la coin supérieur droit du navigateur %icon.</small>'\r\n        },\r\n\r\n        he_il: {\r\n            ios: '<span dir=\"rtl\">להוספת האפליקציה למסך הבית: ללחוץ על %icon ואז <strong>הוסף למסך הבית</strong>.</span>',\r\n            android: 'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon %icon.</small>'\r\n        },\r\n\r\n        hu_hu: {\r\n            ios: 'Ha hozzá szeretné adni ezt az alkalmazást a kezdőképernyőjéhez, érintse meg a következő ikont: %icon , majd a <strong>Hozzáadás a kezdőképernyőhöz</strong> menüpontot.',\r\n            android: 'Ha hozzá szeretné adni ezt az alkalmazást a kezdőképernyőjéhez, a böngésző menüjében kattintson a <strong>Hozzáadás a kezdőképernyőhöz</strong> menüpontra. <small>A böngésző menüjét a következő ikon megérintésével tudja megnyitni: %icon.</small>'\r\n        },\r\n\r\n        it_it: {\r\n            ios: 'Per aggiungere questa web app alla schermata iniziale: premi %icon e poi <strong>Aggiungi a Home</strong>.',\r\n            android: 'Per aggiungere questa web app alla schermata iniziale, apri il menu opzioni del browser e premi su <strong>Aggiungi alla homescreen</strong>. <small>Puoi accedere al menu premendo il pulsante hardware delle opzioni se la tua device ne ha uno, oppure premendo l\\'icona %icon in alto a destra.</small>'\r\n        },\r\n\r\n        ja_jp: {\r\n            ios: 'このウェプアプリをホーム画面に追加するには、%iconをタップして<strong>ホーム画面に追加</strong>してください。',\r\n            android: 'このウェプアプリをホーム画面に追加するには、ブラウザのオプションメニューから<strong>ホーム画面に追加</strong>をタップしてください。<small>オプションメニューは、一部の機種ではデバイスのメニューボタンから、それ以外では画面右上の%iconからアクセスできます。</small>'\r\n        },\r\n\r\n        ko_kr: {\r\n            ios: '홈 화면에 바로가기 생성: %icon 을 클릭한 후 <strong>홈 화면에 추가</strong>.',\r\n            android: '브라우저 옵션 메뉴의 <string>홈 화면에 추가</string>를 클릭하여 홈화면에 바로가기를 생성할 수 있습니다. <small>옵션 메뉴는 장치의 메뉴 버튼을 누르거나 오른쪽 상단의 메뉴 아이콘 %icon을 클릭하여 접근할 수 있습니다.</small>'\r\n        },\r\n\r\n        nb_no: {\r\n            ios: 'For å installere denne appen på hjem-skjermen: trykk på %icon og deretter <strong>Legg til på Hjem-skjerm</strong>.',\r\n            android: 'For å legge til denne webappen på startsiden åpner en nettlesermenyen og velger <strong>Legg til på startsiden</strong>. <small>Menyen åpnes ved å trykke på den fysiske menyknappen hvis enheten har det, eller ved å trykke på menyikonet øverst til høyre %icon.</small>'\r\n        },\r\n\r\n        pt_br: {\r\n            ios: 'Para adicionar este app à tela de início: clique %icon e então <strong>Tela de início</strong>.',\r\n            android: 'Para adicionar este app à tela de início, abra o menu de opções do navegador e selecione <strong>Adicionar à tela inicial</strong>. <small>O menu pode ser acessado pressionando o \"menu\" button se o seu dispositivo tiver um, ou selecionando o ícone %icon no canto superior direito.</small>'\r\n        },\r\n\r\n        pt_pt: {\r\n            ios: 'Para adicionar esta app ao ecrã principal: clique %icon e depois <strong>Ecrã principal</strong>.',\r\n            android: 'Para adicionar esta app web ecrã principal, abra o menu de opções do navegador e selecione <strong>Adicionar à tela inicial</strong>. <small>O menu pode ser acessado pressionando o \"menu\" button se o seu dispositivo tiver um, ou selecionando o ícone %icon no canto superior direito.</small>'\r\n        },\r\n\r\n        nl_nl: {\r\n            ios: 'Om deze webapp aan je startscherm toe te voegen, klik op %icon en dan <strong>Zet in startscherm</strong>.',\r\n            android: 'Om deze webapp aan je startscherm toe te voegen, open de browserinstellingen en tik op <strong>Toevoegen aan startscherm</strong>. <small>Gebruik de \"menu\" knop als je telefoon die heeft, anders het menu-icoon rechtsbovenin %icon.</small>'\r\n        },\r\n\r\n        ru_ru: {\r\n            ios: 'Чтобы добавить этот сайт на свой домашний экран, нажмите на иконку %icon и затем <strong>На экран \"Домой\"</strong>.',\r\n            android: 'Чтобы добавить сайт на свой домашний экран, откройте меню браузера и нажмите на <strong>Добавить на главный экран</strong>. <small>Меню можно вызвать, нажав на кнопку меню вашего телефона, если она есть. Или найдите иконку сверху справа %icon[иконка].</small>'\r\n        },\r\n\r\n        sk_sk: {\r\n            ios: 'Pre pridanie tejto webovej aplikácie na úvodnú obrazovku: stlačte %icon a potom <strong>Pridať na úvodnú obrazovku</strong>.',\r\n            android: 'Pre pridanie tejto webovej aplikácie na úvodnú obrazovku otvorte menu nastavenia prehliadača a stlačte <strong>Pridať na úvodnú obrazovku</strong>. <small>K menu sa dostanete stlačením hardwaroveho tlačidla, ak ho vaše zariadenie má, alebo stlačením pravej hornej menu ikony <span class=\"ath-action-icon\">icon</span>.</small>'\r\n        },\r\n\r\n        sv_se: {\r\n            ios: 'För att lägga till denna webbapplikation på hemskärmen: tryck på %icon och därefter <strong>Lägg till på hemskärmen</strong>.',\r\n            android: 'För att lägga till den här webbappen på hemskärmen öppnar du webbläsarens alternativ-meny och väljer <strong>Lägg till på startskärmen</strong>. <small>Man hittar menyn genom att trycka på hårdvaruknappen om din enhet har en sådan, eller genom att trycka på menyikonen högst upp till höger %icon.</small>'\r\n        },\r\n\r\n        tr_tr: {\r\n            ios: 'Uygulamayı ana ekrana eklemek için, %icon ve ardından <strong>ana ekrana ekle</strong> butonunu tıklayın.',\r\n            android: 'Uygulamayı ana ekrana eklemek için, menüye girin ve <strong>ana ekrana ekle</strong> butonunu tıklayın. <small>Cihazınız menü tuşuna sahip ise menüye girmek için menü tuşunu tıklayın. Aksi takdirde %icon butonunu tıklayın.</small>'\r\n        },\r\n\r\n        uk_ua: {\r\n            ios: 'Щоб додати цей сайт на початковий екран, натисніть %icon, а потім <strong>На початковий екран</strong>.',\r\n            android: 'Щоб додати цей сайт на домашній екран, відкрийте меню браузера та виберіть <strong>Додати на головний екран</strong>. <small>Це можливо зробити, натиснувши кнопку меню на вашому смартфоні, якщо така є. Або ж на іконці зверху справа %icon.</small>'\r\n        },\r\n\r\n        zh_cn: {\r\n            ios: '如要把应用程序加至主屏幕,请点击%icon, 然后<strong>添加到主屏幕</strong>',\r\n            android: 'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon %icon.</small>'\r\n        },\r\n\r\n        zh_tw: {\r\n            ios: '如要把應用程式加至主屏幕, 請點擊%icon, 然後<strong>加至主屏幕</strong>.',\r\n            android: 'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon %icon.</small>'\r\n        }\r\n    };\r\n\r\n    // Add 2 characters language support (Android mostly)\r\n    for (var lang in ath.intl) {\r\n        ath.intl[lang.substr(0, 2)] = ath.intl[lang];\r\n    }\r\n\r\n    // default options\r\n    ath.defaults = {\r\n        appID: 'org.cubiq.addtohome',\t\t// local storage name (no need to change)\r\n        fontSize: 15,\t\t\t\t// base font size, used to properly resize the popup based on viewport scale factor\r\n        debug: false,\t\t\t\t// override browser checks\r\n        logging: false,\t\t\t\t// log reasons for showing or not showing to js console; defaults to true when debug is true\r\n        modal: false,\t\t\t\t// prevent further actions until the message is closed\r\n        mandatory: false,\t\t\t// you can't proceed if you don't add the app to the homescreen\r\n        autostart: true,\t\t\t// show the message automatically\r\n        skipFirstVisit: false,\t\t// show only to returning visitors (ie: skip the first time you visit)\r\n        startDelay: 1,\t\t\t\t// display the message after that many seconds from page load\r\n        lifespan: 15,\t\t\t\t// life of the message in seconds\r\n        displayPace: 1440,\t\t\t// minutes before the message is shown again (0: display every time, default 24 hours)\r\n        maxDisplayCount: 0,\t\t\t// absolute maximum number of times the message will be shown to the user (0: no limit)\r\n        icon: true,\t\t\t\t\t// add touch icon to the message\r\n        message: '',\t\t\t\t// the message can be customized\r\n        validLocation: [],\t\t\t// list of pages where the message will be shown (array of regexes)\r\n        onInit: null,\t\t\t\t// executed on instance creation\r\n        onShow: null,\t\t\t\t// executed when the message is shown\r\n        onRemove: null,\t\t\t\t// executed when the message is removed\r\n        onAdd: null,\t\t\t\t// when the application is launched the first time from the homescreen (guesstimate)\r\n        onPrivate: null,\t\t\t// executed if user is in private mode\r\n        privateModeOverride: false,\t// show the message even in private mode (very rude)\r\n        detectHomescreen: false\t\t// try to detect if the site has been added to the homescreen (false | true | 'hash' | 'queryString' | 'smartURL')\r\n    };\r\n\r\n    // browser info and capability\r\n    var _ua = window.navigator.userAgent;\r\n\r\n    var _nav = window.navigator;\r\n    _extend(ath, {\r\n        hasToken: document.location.hash == '#ath' || _reSmartURL.test(document.location.href) || _reQueryString.test(document.location.search),\r\n        isRetina: window.devicePixelRatio && window.devicePixelRatio > 1,\r\n        isIDevice: (/iphone|ipod|ipad/i).test(_ua),\r\n        isMobileChrome: _ua.indexOf('Android') > -1 && (/Chrome\\/[.0-9]*/).test(_ua) && _ua.indexOf(\"Version\") == -1,\r\n        isMobileIE: _ua.indexOf('Windows Phone') > -1,\r\n        language: _nav.language && _nav.language.toLowerCase().replace('-', '_') || ''\r\n    });\r\n\r\n    // falls back to en_us if language is unsupported\r\n    ath.language = ath.language && ath.language in ath.intl ? ath.language : 'en_us';\r\n\r\n    ath.isMobileSafari = ath.isIDevice && _ua.indexOf('Safari') > -1 && _ua.indexOf('CriOS') < 0;\r\n    ath.OS = ath.isIDevice ? 'ios' : ath.isMobileChrome ? 'android' : ath.isMobileIE ? 'windows' : 'unsupported';\r\n\r\n    ath.OSVersion = _ua.match(/(OS|Android) (\\d+[_\\.]\\d+)/);\r\n    ath.OSVersion = ath.OSVersion && ath.OSVersion[2] ? +ath.OSVersion[2].replace('_', '.') : 0;\r\n\r\n    ath.isStandalone = 'standalone' in window.navigator && window.navigator.standalone;\r\n    ath.isTablet = (ath.isMobileSafari && _ua.indexOf('iPad') > -1) || (ath.isMobileChrome && _ua.indexOf('Mobile') < 0);\r\n\r\n    ath.isCompatible = (ath.isMobileSafari && ath.OSVersion >= 6) || ath.isMobileChrome;\t// TODO: add winphone\r\n\r\n    var _defaultSession = {\r\n        lastDisplayTime: 0,\t\t\t// last time we displayed the message\r\n        returningVisitor: false,\t// is this the first time you visit\r\n        displayCount: 0,\t\t\t// number of times the message has been shown\r\n        optedout: false,\t\t\t// has the user opted out\r\n        added: false\t\t\t\t// has been actually added to the homescreen\r\n    };\r\n\r\n    ath.removeSession = function (appID) {\r\n        try {\r\n            if (!localStorage) {\r\n                throw new Error('localStorage is not defined');\r\n            }\r\n\r\n            localStorage.removeItem(appID || ath.defaults.appID);\r\n        } catch (e) {\r\n            // we are most likely in private mode\r\n        }\r\n    };\r\n\r\n    ath.doLog = function (logStr) {\r\n        if (this.options.logging) {\r\n            console.log(logStr);\r\n        }\r\n    };\r\n\r\n    ath.Class = function (options) {\r\n        // class methods\r\n        this.doLog = ath.doLog;\r\n\r\n        // merge default options with user config\r\n        this.options = _extend({}, ath.defaults);\r\n        _extend(this.options, options);\r\n        // override defaults that are dependent on each other\r\n        if (this.options && this.options.debug && (typeof this.options.logging === \"undefined\")) {\r\n            this.options.logging = true;\r\n        }\r\n\r\n        // IE<9 so exit (I hate you, really)\r\n        if (!_eventListener) {\r\n            return;\r\n        }\r\n\r\n        // normalize some options\r\n        this.options.mandatory = this.options.mandatory && ('standalone' in window.navigator || this.options.debug);\r\n        this.options.modal = this.options.modal || this.options.mandatory;\r\n        if (this.options.mandatory) {\r\n            this.options.startDelay = -0.5;\t\t// make the popup hasty\r\n        }\r\n        this.options.detectHomescreen = this.options.detectHomescreen === true ? 'hash' : this.options.detectHomescreen;\r\n\r\n        // setup the debug environment\r\n        if (this.options.debug) {\r\n            ath.isCompatible = true;\r\n            ath.OS = typeof this.options.debug == 'string' ? this.options.debug : ath.OS == 'unsupported' ? 'android' : ath.OS;\r\n            ath.OSVersion = ath.OS == 'ios' ? '8' : '4';\r\n        }\r\n\r\n        // the element the message will be appended to\r\n        this.container = document.body;\r\n\r\n        // load session\r\n        this.session = this.getItem(this.options.appID);\r\n        this.session = this.session ? JSON.parse(this.session) : undefined;\r\n\r\n        // user most likely came from a direct link containing our token, we don't need it and we remove it\r\n        if (ath.hasToken && (!ath.isCompatible || !this.session)) {\r\n            ath.hasToken = false;\r\n            _removeToken();\r\n        }\r\n\r\n        // the device is not supported\r\n        if (!ath.isCompatible) {\r\n            this.doLog(\"Add to homescreen: not displaying callout because device not supported\");\r\n            return;\r\n        }\r\n\r\n        this.session = this.session || _defaultSession;\r\n\r\n        // check if we can use the local storage\r\n        try {\r\n            if (!localStorage) {\r\n                throw new Error('localStorage is not defined');\r\n            }\r\n\r\n            localStorage.setItem(this.options.appID, JSON.stringify(this.session));\r\n            ath.hasLocalStorage = true;\r\n        } catch (e) {\r\n            // we are most likely in private mode\r\n            ath.hasLocalStorage = false;\r\n\r\n            if (this.options.onPrivate) {\r\n                this.options.onPrivate.call(this);\r\n            }\r\n        }\r\n\r\n        // check if this is a valid location\r\n        var isValidLocation = !this.options.validLocation.length;\r\n        for (var i = this.options.validLocation.length; i--;) {\r\n            if (this.options.validLocation[i].test(document.location.href)) {\r\n                isValidLocation = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        // check compatibility with old versions of add to homescreen. Opt-out if an old session is found\r\n        if (this.getItem('addToHome')) {\r\n            this.optOut();\r\n        }\r\n\r\n        // critical errors:\r\n        if (this.session.optedout) {\r\n            this.doLog(\"Add to homescreen: not displaying callout because user opted out\");\r\n            return;\r\n        }\r\n        if (this.session.added) {\r\n            this.doLog(\"Add to homescreen: not displaying callout because already added to the homescreen\");\r\n            return;\r\n        }\r\n        if (!isValidLocation) {\r\n            this.doLog(\"Add to homescreen: not displaying callout because not a valid location\");\r\n            return;\r\n        }\r\n\r\n        // check if the app is in stand alone mode\r\n        if (ath.isStandalone) {\r\n            // execute the onAdd event if we haven't already\r\n            if (!this.session.added) {\r\n                this.session.added = true;\r\n                this.updateSession();\r\n\r\n                if (this.options.onAdd && ath.hasLocalStorage) {\t// double check on localstorage to avoid multiple calls to the custom event\r\n                    this.options.onAdd.call(this);\r\n                }\r\n            }\r\n\r\n            this.doLog(\"Add to homescreen: not displaying callout because in standalone mode\");\r\n            return;\r\n        }\r\n\r\n        // (try to) check if the page has been added to the homescreen\r\n        if (this.options.detectHomescreen) {\r\n            // the URL has the token, we are likely coming from the homescreen\r\n            if (ath.hasToken) {\r\n                _removeToken();\t\t// we don't actually need the token anymore, we remove it to prevent redistribution\r\n\r\n                // this is called the first time the user opens the app from the homescreen\r\n                if (!this.session.added) {\r\n                    this.session.added = true;\r\n                    this.updateSession();\r\n\r\n                    if (this.options.onAdd && ath.hasLocalStorage) {\t// double check on localstorage to avoid multiple calls to the custom event\r\n                        this.options.onAdd.call(this);\r\n                    }\r\n                }\r\n\r\n                this.doLog(\"Add to homescreen: not displaying callout because URL has token, so we are likely coming from homescreen\");\r\n                return;\r\n            }\r\n\r\n            // URL doesn't have the token, so add it\r\n            if (this.options.detectHomescreen == 'hash') {\r\n                history.replaceState('', window.document.title, document.location.href + '#ath');\r\n            } else if (this.options.detectHomescreen == 'smartURL') {\r\n                history.replaceState('', window.document.title, document.location.href.replace(/(\\/)?$/, '/ath$1'));\r\n            } else {\r\n                history.replaceState('', window.document.title, document.location.href + (document.location.search ? '&' : '?') + 'ath=');\r\n            }\r\n        }\r\n\r\n        // check if this is a returning visitor\r\n        if (!this.session.returningVisitor) {\r\n            this.session.returningVisitor = true;\r\n            this.updateSession();\r\n\r\n            // we do not show the message if this is your first visit\r\n            if (this.options.skipFirstVisit) {\r\n                this.doLog(\"Add to homescreen: not displaying callout because skipping first visit\");\r\n                return;\r\n            }\r\n        }\r\n\r\n        // we do no show the message in private mode\r\n        if (!this.options.privateModeOverride && !ath.hasLocalStorage) {\r\n            this.doLog(\"Add to homescreen: not displaying callout because browser is in private mode\");\r\n            return;\r\n        }\r\n\r\n        // all checks passed, ready to display\r\n        this.ready = true;\r\n\r\n        if (this.options.onInit) {\r\n            this.options.onInit.call(this);\r\n        }\r\n\r\n        if (this.options.autostart) {\r\n            this.doLog(\"Add to homescreen: autostart displaying callout\");\r\n            this.show();\r\n        }\r\n    };\r\n\r\n    ath.Class.prototype = {\r\n        // event type to method conversion\r\n        events: {\r\n            load: '_delayedShow',\r\n            error: '_delayedShow',\r\n            orientationchange: 'resize',\r\n            resize: 'resize',\r\n            scroll: 'resize',\r\n            click: 'remove',\r\n            touchmove: '_preventDefault',\r\n            transitionend: '_removeElements',\r\n            webkitTransitionEnd: '_removeElements',\r\n            MSTransitionEnd: '_removeElements'\r\n        },\r\n\r\n        handleEvent: function (e) {\r\n            var type = this.events[e.type];\r\n            if (type) {\r\n                this[type](e);\r\n            }\r\n        },\r\n\r\n        show: function (force) {\r\n            // in autostart mode wait for the document to be ready\r\n            if (this.options.autostart && !_DOMReady) {\r\n                setTimeout(this.show.bind(this), 50);\r\n                // we are not displaying callout because DOM not ready, but don't log that because\r\n                // it would log too frequently\r\n                return;\r\n            }\r\n\r\n            // message already on screen\r\n            if (this.shown) {\r\n                this.doLog(\"Add to homescreen: not displaying callout because already shown on screen\");\r\n                return;\r\n            }\r\n\r\n            var now = Date.now();\r\n            var lastDisplayTime = this.session.lastDisplayTime;\r\n\r\n            if (force !== true) {\r\n                // this is needed if autostart is disabled and you programmatically call the show() method\r\n                if (!this.ready) {\r\n                    this.doLog(\"Add to homescreen: not displaying callout because not ready\");\r\n                    return;\r\n                }\r\n\r\n                // we obey the display pace (prevent the message to popup too often)\r\n                if (now - lastDisplayTime < this.options.displayPace * 60000) {\r\n                    this.doLog(\"Add to homescreen: not displaying callout because displayed recently\");\r\n                    return;\r\n                }\r\n\r\n                // obey the maximum number of display count\r\n                if (this.options.maxDisplayCount && this.session.displayCount >= this.options.maxDisplayCount) {\r\n                    this.doLog(\"Add to homescreen: not displaying callout because displayed too many times already\");\r\n                    return;\r\n                }\r\n            }\r\n\r\n            this.shown = true;\r\n\r\n            // increment the display count\r\n            this.session.lastDisplayTime = now;\r\n            this.session.displayCount++;\r\n            this.updateSession();\r\n\r\n            // try to get the highest resolution application icon\r\n            if (!this.applicationIcon) {\r\n                if (ath.OS == 'ios') {\r\n                    this.applicationIcon = document.querySelector('head link[rel^=apple-touch-icon][sizes=\"152x152\"],head link[rel^=apple-touch-icon][sizes=\"144x144\"],head link[rel^=apple-touch-icon][sizes=\"120x120\"],head link[rel^=apple-touch-icon][sizes=\"114x114\"],head link[rel^=apple-touch-icon]');\r\n                } else {\r\n                    this.applicationIcon = document.querySelector('head link[rel^=\"shortcut icon\"][sizes=\"196x196\"],head link[rel^=apple-touch-icon]');\r\n                }\r\n            }\r\n\r\n            var message = '';\r\n\r\n            if (typeof this.options.message == 'object' && ath.language in this.options.message) {\t\t// use custom language message\r\n                message = this.options.message[ath.language][ath.OS];\r\n            } else if (typeof this.options.message == 'object' && ath.OS in this.options.message) {\t\t// use custom os message\r\n                message = this.options.message[ath.OS];\r\n            } else if (this.options.message in ath.intl) {\t\t\t\t// you can force the locale\r\n                message = ath.intl[this.options.message][ath.OS];\r\n            } else if (this.options.message !== '') {\t\t\t\t\t\t// use a custom message\r\n                message = this.options.message;\r\n            } else if (ath.OS in ath.intl[ath.language]) {\t\t\t\t// otherwise we use our message\r\n                message = ath.intl[ath.language][ath.OS];\r\n            }\r\n\r\n            // add the action icon\r\n            message = '<p>' + message.replace(/%icon(?:\\[([^\\]]+)\\])?/gi, function (matches, group1) {\r\n                return '<span class=\"ath-action-icon\">' + (!!group1 ? group1 : 'icon') + '</span>';\r\n            }) + '</p>';\r\n\r\n            // create the message container\r\n            this.viewport = document.createElement('div');\r\n            this.viewport.className = 'ath-viewport';\r\n            if (this.options.modal) {\r\n                this.viewport.className += ' ath-modal';\r\n            }\r\n            if (this.options.mandatory) {\r\n                this.viewport.className += ' ath-mandatory';\r\n            }\r\n            this.viewport.style.position = 'absolute';\r\n\r\n            // create the actual message element\r\n            this.element = document.createElement('div');\r\n            this.element.className = 'ath-container ath-' + ath.OS + ' ath-' + ath.OS + (parseInt(ath.OSVersion) || '') + ' ath-' + (ath.isTablet ? 'tablet' : 'phone');\r\n            this.element.style.cssText = '-webkit-transition-property:-webkit-transform,opacity;-webkit-transition-duration:0s;-webkit-transition-timing-function:ease-out;transition-property:transform,opacity;transition-duration:0s;transition-timing-function:ease-out;';\r\n            this.element.style.webkitTransform = 'translate3d(0,-' + window.innerHeight + 'px,0)';\r\n            this.element.style.transform = 'translate3d(0,-' + window.innerHeight + 'px,0)';\r\n\r\n            // add the application icon\r\n            if (this.options.icon && this.applicationIcon) {\r\n                this.element.className += ' ath-icon';\r\n                this.img = document.createElement('img');\r\n                this.img.className = 'ath-application-icon';\r\n                this.img.addEventListener('load', this, false);\r\n                this.img.addEventListener('error', this, false);\r\n\r\n                this.img.src = this.applicationIcon.href;\r\n                this.element.appendChild(this.img);\r\n            }\r\n\r\n            this.element.innerHTML += message;\r\n\r\n            // we are not ready to show, place the message out of sight\r\n            this.viewport.style.left = '-99999em';\r\n\r\n            // attach all elements to the DOM\r\n            this.viewport.appendChild(this.element);\r\n            this.container.appendChild(this.viewport);\r\n\r\n            // if we don't have to wait for an image to load, show the message right away\r\n            if (this.img) {\r\n                this.doLog(\"Add to homescreen: not displaying callout because waiting for img to load\");\r\n            } else {\r\n                this._delayedShow();\r\n            }\r\n        },\r\n\r\n        _delayedShow: function (e) {\r\n            setTimeout(this._show.bind(this), this.options.startDelay * 1000 + 500);\r\n        },\r\n\r\n        _show: function () {\r\n            var that = this;\r\n\r\n            // update the viewport size and orientation\r\n            this.updateViewport();\r\n\r\n            // reposition/resize the message on orientation change\r\n            window.addEventListener('resize', this, false);\r\n            window.addEventListener('scroll', this, false);\r\n            window.addEventListener('orientationchange', this, false);\r\n\r\n            if (this.options.modal) {\r\n                // lock any other interaction\r\n                document.addEventListener('touchmove', this, true);\r\n            }\r\n\r\n            // Enable closing after 1 second\r\n            if (!this.options.mandatory) {\r\n                setTimeout(function () {\r\n                    that.element.addEventListener('click', that, true);\r\n                }, 1000);\r\n            }\r\n\r\n            // kick the animation\r\n            setTimeout(function () {\r\n                that.element.style.webkitTransitionDuration = '1.2s';\r\n                that.element.style.transitionDuration = '1.2s';\r\n                that.element.style.webkitTransform = 'translate3d(0,0,0)';\r\n                that.element.style.transform = 'translate3d(0,0,0)';\r\n            }, 0);\r\n\r\n            // set the destroy timer\r\n            if (this.options.lifespan) {\r\n                this.removeTimer = setTimeout(this.remove.bind(this), this.options.lifespan * 1000);\r\n            }\r\n\r\n            // fire the custom onShow event\r\n            if (this.options.onShow) {\r\n                this.options.onShow.call(this);\r\n            }\r\n        },\r\n\r\n        remove: function () {\r\n            clearTimeout(this.removeTimer);\r\n\r\n            // clear up the event listeners\r\n            if (this.img) {\r\n                this.img.removeEventListener('load', this, false);\r\n                this.img.removeEventListener('error', this, false);\r\n            }\r\n\r\n            window.removeEventListener('resize', this, false);\r\n            window.removeEventListener('scroll', this, false);\r\n            window.removeEventListener('orientationchange', this, false);\r\n            document.removeEventListener('touchmove', this, true);\r\n            this.element.removeEventListener('click', this, true);\r\n\r\n            // remove the message element on transition end\r\n            this.element.addEventListener('transitionend', this, false);\r\n            this.element.addEventListener('webkitTransitionEnd', this, false);\r\n            this.element.addEventListener('MSTransitionEnd', this, false);\r\n\r\n            // start the fade out animation\r\n            this.element.style.webkitTransitionDuration = '0.3s';\r\n            this.element.style.opacity = '0';\r\n        },\r\n\r\n        _removeElements: function () {\r\n            this.element.removeEventListener('transitionend', this, false);\r\n            this.element.removeEventListener('webkitTransitionEnd', this, false);\r\n            this.element.removeEventListener('MSTransitionEnd', this, false);\r\n\r\n            // remove the message from the DOM\r\n            this.container.removeChild(this.viewport);\r\n\r\n            this.shown = false;\r\n\r\n            // fire the custom onRemove event\r\n            if (this.options.onRemove) {\r\n                this.options.onRemove.call(this);\r\n            }\r\n        },\r\n\r\n        updateViewport: function () {\r\n            if (!this.shown) {\r\n                return;\r\n            }\r\n\r\n            this.viewport.style.width = window.innerWidth + 'px';\r\n            this.viewport.style.height = window.innerHeight + 'px';\r\n            this.viewport.style.left = window.scrollX + 'px';\r\n            this.viewport.style.top = window.scrollY + 'px';\r\n\r\n            var clientWidth = document.documentElement.clientWidth;\r\n\r\n            this.orientation = clientWidth > document.documentElement.clientHeight ? 'landscape' : 'portrait';\r\n\r\n            var screenWidth = ath.OS == 'ios' ? this.orientation == 'portrait' ? screen.width : screen.height : screen.width;\r\n            this.scale = screen.width > clientWidth ? 1 : screenWidth / window.innerWidth;\r\n\r\n            this.element.style.fontSize = this.options.fontSize / this.scale + 'px';\r\n        },\r\n\r\n        resize: function () {\r\n            clearTimeout(this.resizeTimer);\r\n            this.resizeTimer = setTimeout(this.updateViewport.bind(this), 100);\r\n        },\r\n\r\n        updateSession: function () {\r\n            if (ath.hasLocalStorage === false) {\r\n                return;\r\n            }\r\n\r\n            if (localStorage) {\r\n                localStorage.setItem(this.options.appID, JSON.stringify(this.session));\r\n            }\r\n        },\r\n\r\n        clearSession: function () {\r\n            this.session = _defaultSession;\r\n            this.updateSession();\r\n        },\r\n\r\n        getItem: function (item) {\r\n            try {\r\n                if (!localStorage) {\r\n                    throw new Error('localStorage is not defined');\r\n                }\r\n\r\n                return localStorage.getItem(item);\r\n            } catch (e) {\r\n                // Preventing exception for some browsers when fetching localStorage key\r\n                ath.hasLocalStorage = false;\r\n            }\r\n        },\r\n\r\n        optOut: function () {\r\n            this.session.optedout = true;\r\n            this.updateSession();\r\n        },\r\n\r\n        optIn: function () {\r\n            this.session.optedout = false;\r\n            this.updateSession();\r\n        },\r\n\r\n        clearDisplayCount: function () {\r\n            this.session.displayCount = 0;\r\n            this.updateSession();\r\n        },\r\n\r\n        _preventDefault: function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n\r\n    // utility\r\n    function _extend(target, obj) {\r\n        for (var i in obj) {\r\n            target[i] = obj[i];\r\n        }\r\n\r\n        return target;\r\n    }\r\n\r\n    function _removeToken() {\r\n        if (document.location.hash == '#ath') {\r\n            history.replaceState('', window.document.title, document.location.href.split('#')[0]);\r\n        }\r\n\r\n        if (_reSmartURL.test(document.location.href)) {\r\n            history.replaceState('', window.document.title, document.location.href.replace(_reSmartURL, '$1'));\r\n        }\r\n\r\n        if (_reQueryString.test(document.location.search)) {\r\n            history.replaceState('', window.document.title, document.location.href.replace(_reQueryString, '$2'));\r\n        }\r\n    }\r\n\r\n    // expose to the world\r\n    window.addToHomescreen = ath;\r\n\r\n})(window, document);"]}